# Documenta√ß√£o WhosDo

Bem-vindo √† documenta√ß√£o do projeto WhosDo! Aqui voc√™ encontra guias, padr√µes, processos e refer√™ncias para desenvolvimento, design, opera√ß√£o e evolu√ß√£o do sistema.

> **√öltima revis√£o:** 24/06/2025  
> **Respons√°vel:** Micael Bento

## √çndice Geral

- **Visual, Design e UX**
  - [Guia Visual Unificado](./guia-visual/guia-visual-unificado.md)
  - [Padroniza√ß√£o de Bot√µes](./guia-visual/padronizacao-botoes.md)
  - [Modelos de Documenta√ß√£o](./guia-visual/README-modelo.md)
  - [Modelo de Automa√ß√£o](./guia-visual/README-modelo-automacao.md)
  - [An√°lise UX Frontend](./guia-visual/frontend-ux-visual-analysis.md)
- **Produto e Dom√≠nio**
  - [Apresenta√ß√£o do Produto](./apresentacao/whosdo-apresentacao.md)
  - [Tipos de An√∫ncios](./anuncios/tipos-de-anuncios.md)
  - [Planejamento de Layout de Perfil](./planejamento/profile-layout-planning.md)
  - [Blueprint do Projeto](./planejamento/blueprint.md)
- **Arquitetura e Estrutura**
  - [Guia de Estrutura e Recupera√ß√£o do Projeto](./planejamento/project-structure-and-recovery-guide.md)
  - [Plano de Refatora√ß√£o Arquitetural](./planejamento/architectural-refactoring-plan.md)
- **Infraestrutura e Deploy**
  - [Guia de Infraestrutura e Opera√ß√µes](./infraestrutura/infrastructure-and-operations-guide.md)
  - [Estrat√©gia de Hospedagem e Deploy](./infraestrutura/hosting-and-deployment-strategy.md)
- **Processos e Melhoria Cont√≠nua**
  - [Roteiro de Reestrutura√ß√£o](./planejamento/roteiro-reestruturacao.md)
- **Pagamentos e Cr√©ditos**
  - [Documenta√ß√£o de Pagamentos e Cr√©ditos](./pagamentos-e-creditos/README.md)
- **Messenger (Chat)**
  - [Messenger: Planejamento, Arquitetura e Roteiro](./messenger.md)

---

## Como navegar
- Use o √≠ndice acima para encontrar rapidamente o documento desejado.
- Consulte o [Guia Visual Unificado](./guia-visual/guia-visual-unificado.md) para qualquer d√∫vida sobre padr√µes visuais, tokens, temas ou componentes de UI.
- Para d√∫vidas sobre processos, arquitetura ou dom√≠nio, consulte a se√ß√£o correspondente.
- Sempre que atualizar um padr√£o, processo ou estrutura, lembre-se de atualizar a documenta√ß√£o!

---

> D√∫vidas, sugest√µes ou contribui√ß√µes? Consulte o arquivo CONTRIBUTING.md (se dispon√≠vel) ou abra uma issue/pull request no reposit√≥rio, ou entre em contato com o time respons√°vel.

## Objetivo
- Centralizar o conhecimento do projeto para facilitar onboarding, manuten√ß√£o e evolu√ß√£o.
- Garantir que cada √°rea (visual, pagamentos, infraestrutura, UX, etc) tenha documenta√ß√£o clara e atualizada.

## Estrutura dos Arquivos
- `guia-visual/`: Guias visuais, padroniza√ß√£o de componentes, modelos e an√°lise UX.
- `pagamentos-e-creditos/`: Sistema de cr√©ditos, monetiza√ß√£o e pagamentos.
- `anuncios/`: Tipos e modelos de an√∫ncios.
- `planejamento/`: Planejamento, estrutura, roteiros e blueprints do projeto.
- `infraestrutura/`: Deploy, monitoramento e opera√ß√µes.
- `apresentacao/`: Apresenta√ß√£o institucional do produto.

## Como usar
- Consulte o README de cada subpasta para entender o objetivo e estrutura de cada √°rea.
- Sempre que criar uma nova √°rea, utilize o modelo `README-modelo.md` em `guia-visual/`.
- Atualize a documenta√ß√£o sempre que houver mudan√ßas relevantes no c√≥digo.

## Boas pr√°ticas
- Mantenha exemplos reais e pr√°ticos sempre que poss√≠vel.
- Use nomes claros para arquivos e pastas.
- Incentive o time a documentar mudan√ßas imediatamente ap√≥s altera√ß√µes no c√≥digo.

## √çndice de Documenta√ß√£o
- [Guia Visual Unificado](./guia-visual/guia-visual-unificado.md): Diretrizes visuais, tokens, temas, componentes e boas pr√°ticas de UI/UX.
- [Padroniza√ß√£o de Bot√µes](./guia-visual/padronizacao-botoes.md): Guia visual e t√©cnico para bot√µes.
- [Modelos de Documenta√ß√£o](./guia-visual/README-modelo.md): Estrutura sugerida para novos documentos.
- [Modelo de Automa√ß√£o](./guia-visual/README-modelo-automacao.md): Exemplo de automa√ß√£o de documenta√ß√£o.
- [An√°lise UX Frontend](./guia-visual/frontend-ux-visual-analysis.md): Avalia√ß√£o e recomenda√ß√µes de UX/UI.
- [Apresenta√ß√£o do Produto](./apresentacao/whosdo-apresentacao.md): Vis√£o institucional do projeto.
- [Tipos de An√∫ncios](./anuncios/tipos-de-anuncios.md): Detalhamento dos formatos de an√∫ncio.
- [Planejamento de Layouts de Perfil](./planejamento/profile-layout-planning.md): Estrat√©gias e exemplos de layouts de perfil.
- [Blueprint do Projeto](./planejamento/blueprint.md): Vis√£o geral, objetivos e arquitetura.
- [Guia de Estrutura e Recupera√ß√£o](./planejamento/project-structure-and-recovery-guide.md): Organiza√ß√£o e recupera√ß√£o do projeto.
- [Plano de Refatora√ß√£o Arquitetural](./planejamento/architectural-refactoring-plan.md): Estrat√©gia para refatora√ß√£o do c√≥digo.
- [Roteiro de Reestrutura√ß√£o](./planejamento/roteiro-reestruturacao.md): Passo a passo para mudan√ßas estruturais.
- [Guia de Infraestrutura e Opera√ß√µes](./infraestrutura/infrastructure-and-operations-guide.md): Deploy, monitoramento e boas pr√°ticas de opera√ß√£o.
- [Estrat√©gia de Hospedagem e Deploy](./infraestrutura/hosting-and-deployment-strategy.md): Estrat√©gias de hospedagem e publica√ß√£o.
- [Documenta√ß√£o de Pagamentos e Cr√©ditos](./pagamentos-e-creditos/README.md): Planejamento, regras e integra√ß√µes do sistema de cr√©ditos e monetiza√ß√£o.
- [Messenger: Planejamento, Arquitetura e Roteiro](./messenger.md): Detalhamento t√©cnico e de neg√≥cio do sistema de chat/mensageria.

## Como contribuir
- Sempre que alterar algo fundamental (visual, regras de neg√≥cio, infraestrutura), atualize a documenta√ß√£o correspondente.
- Use os READMEs das subpastas como ponto de partida para entender cada √°rea.
- Em caso de d√∫vida, consulte este √≠ndice ou pergunte ao time respons√°vel.
- Para sugest√µes, utilize issues ou pull requests no reposit√≥rio.

## Acompanhamento de Progresso e Pr√≥ximos Passos

Para garantir a evolu√ß√£o cont√≠nua e organizada do projeto, mantenha sempre um documento de acompanhamento de progresso (como o `NEXT_STEPS.md` na raiz do projeto). Utilize este espa√ßo para registrar:

- Revis√µes peri√≥dicas da documenta√ß√£o e do c√≥digo.
- Pend√™ncias identificadas em revis√µes (ex: pontos a atualizar em README, docs, scripts, rotas, migrations, etc).
- Checklist de produ√ß√£o e deploy.
- Itens conclu√≠dos e pr√≥ximos passos.
- Respons√°veis por cada tarefa ou revis√£o.

### Revis√£o mais recente

**Data:** 24/06/2025  
**Respons√°vel:** Micael Bento

**Principais pontos identificados:**
- README.md (raiz): atualizado com instru√ß√µes e links.
- README.md (apps/web): links e exemplos revisados.
- /docs: √≠ndice atualizado, READMEs revisados.
- project-structure-and-recovery-guide.md: alinhado com a estrutura atual.
- NEXT_STEPS.md: progresso e pr√≥ximos passos detalhados.
- db/, infra/, supabase/: versionamento e documenta√ß√£o em dia.

---

> **Dica:** Use o `NEXT_STEPS.md` como refer√™ncia viva e central de progresso. Atualize-o sempre que houver mudan√ßas importantes, e registre um resumo das revis√µes nesta se√ß√£o do README de documenta√ß√£o.

> **Importante:** Certifique-se de que todas as subpastas de documenta√ß√£o possuem um README explicativo, seguindo o modelo em `guia-visual/README-modelo.md`. Sempre que poss√≠vel, inclua exemplos pr√°ticos e reais para facilitar o entendimento.

---

## [ATUALIZA√á√ÉO 2024-06] ‚Äì Monetiza√ß√£o e Compra de Cr√©ditos

### O que j√° foi implementado:
- P√°gina `/dashboard/credits/buy` exibe pacotes de cr√©ditos e inicia o fluxo de compra via Mercado Pago (frontend funcional, com hooks React liberados por "use client").
- P√°gina `/dashboard/credits/payment-confirmation` processa o retorno do Mercado Pago, chama a API de valida√ß√£o e exibe o status ao usu√°rio.

### Pr√≥ximos passos:
- Implementar as rotas de API `/api/payments/mercadopago/checkout` e `/api/payments/mercadopago/validate`.
- Criar/atualizar o servi√ßo `credits.service.ts` para registrar transa√ß√µes e atualizar saldo.
- Criar migration para tabela de transa√ß√µes de cr√©ditos.

> Ap√≥s esses passos, o fluxo de compra estar√° pronto para testes integrados e homologa√ß√£o.

---

- Atualiza√ß√£o r√°pida: 24/06/2025

<!-- Se√ß√£o Messenger removida, pois agora est√° centralizada em docs/messenger.md -->

## üì¨ Messenger (Chat) ‚Äî Planejamento, Arquitetura e Roteiro de Implementa√ß√£o

### Vis√£o Geral
O Messenger do WhosDo √© um sistema de mensagens tempor√°rias, voltado para negocia√ß√µes r√°pidas entre usu√°rios dos planos Standard e Premium. As conversas s√£o ef√™meras (expiram em 48h), suportam texto e imagens, e contam com notifica√ß√µes em tempo real. O objetivo √© facilitar negocia√ß√µes, n√£o criar um chat social permanente.

---

### Fases e Sprints de Implementa√ß√£o

#### **Fase 1: MVP Funcional e Seguro**

**Sprint 1: Controle de Acesso e Conversa Tempor√°ria**
- Adicionar campo `plan` ao perfil do usu√°rio (se necess√°rio).
- Implementar checagem de plano no frontend (bloquear chat para Free, exibir call-to-action para upgrade).
- Adicionar campo `expires_at` na tabela `conversations`.
- Definir `expires_at = now() + 48h` ao criar conversa.
- Criar trigger/fun√ß√£o agendada para exclus√£o autom√°tica de conversas/mensagens ap√≥s 48h.

**Crit√©rios de Aceite:**
- Usu√°rios Free n√£o acessam o chat.
- Conversas expiram e s√£o exclu√≠das ap√≥s 48h.

**Sprint 2: Lista de Conversas e Chat de Texto**
- Criar p√°gina `/dashboard/messages` listando conversas ativas do usu√°rio.
- Exibir avatar, nome, preview da √∫ltima mensagem, tempo.
- Permitir abrir ChatFloatingBox a partir da lista.
- Ajustar ChatFloatingBox para conversas tempor√°rias (aviso de expira√ß√£o).
- Garantir realtime (Supabase channel) e notifica√ß√µes toast.

**Crit√©rios de Aceite:**
- Usu√°rio v√™ conversas ativas, pode abrir e trocar mensagens de texto em tempo real.
- Recebe notifica√ß√£o toast ao receber nova mensagem.

---

#### **Fase 2: Experi√™ncia Visual e Recursos de Negocia√ß√£o**

**Sprint 3: Upload e Exibi√ß√£o de Imagens**
- Criar bucket no Supabase Storage para imagens de chat.
- Adicionar campos `type` e `image_url` em `messages`.
- Adicionar bot√£o de upload de imagem no chat.
- Implementar upload e salvar mensagem do tipo `image`.
- Renderizar imagens no chat.

**Crit√©rios de Aceite:**
- Usu√°rio pode enviar e visualizar imagens no chat.

**Sprint 4: Indica√ß√£o de Leitura/Entrega (Opcional)**
- Adicionar campo `read_at` em `messages`.
- Atualizar `read_at` ao abrir conversa.
- Exibir status de leitura ("visualizada", "enviada").

**Crit√©rios de Aceite:**
- Usu√°rio v√™ se a mensagem foi lida pelo destinat√°rio.

---

#### **Fase 3: Seguran√ßa, Modera√ß√£o e Escalabilidade**

**Sprint 5: Bloqueio/Den√∫ncia de Usu√°rios (Opcional)**
- Criar tabela `blocked_users`.
- Adicionar bot√£o de bloquear/denunciar no chat.
- Impedir chat entre usu√°rios bloqueados.

**Crit√©rios de Aceite:**
- Usu√°rio pode bloquear/denunciar outro usu√°rio.
- N√£o recebe mais mensagens de usu√°rios bloqueados.

**Sprint 6: Notifica√ß√µes Push Mobile (Opcional)**
- Integrar FCM ou OneSignal.
- Enviar push notification ao receber nova mensagem.

**Crit√©rios de Aceite:**
- Usu√°rio recebe notifica√ß√£o push em dispositivos m√≥veis.

---

### Checklist T√©cnico Resumido
- [ ] Controle de acesso por plano
- [ ] Expira√ß√£o autom√°tica das conversas
- [ ] Lista de conversas recentes
- [ ] Chat de texto em tempo real
- [ ] Upload/exibi√ß√£o de imagens
- [ ] Indica√ß√£o de leitura/entrega (opcional)
- [ ] Bloqueio/den√∫ncia (opcional)
- [ ] Push mobile (opcional)

---

### Observa√ß√µes de Neg√≥cio
- O chat √© exclusivo para planos Standard e Premium.
- Conversas s√£o tempor√°rias (48h) e removidas automaticamente.
- Foco em negocia√ß√£o r√°pida, n√£o em relacionamento cont√≠nuo.
- Imagens s√£o permitidas, com limita√ß√£o de tamanho e tipo.

---

> Para detalhes t√©cnicos, exemplos de c√≥digo e SQL, consulte a documenta√ß√£o interna dos componentes e o README do app web.

Atualizado automaticamente em: 01/07/2025 